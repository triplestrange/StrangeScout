name: strangescout
version: 'git' # pull version from git
version-script: ./.version.sh
summary: StrangeScout Scouting System
description: |
    StrangeScout Scouting System for FRC teams developed by team 1533 Triple Strange

grade: stable # must be 'stable' to release into candidate/stable channels
confinement: strict # use 'strict' once you have the right plugs and slots

apps:
    strangescout:
        command: lib/node_modules/strangescout-server/command.js
        plugs: [network, network-bind]
    service:
        command: lib/node_modules/strangescout-server/service.js
        plugs: [network, network-bind]
        daemon: simple
        restart-condition: on-abnormal

parts:
    strangescout:
        plugin: nodejs
        source: out
        node-engine: 11.10.0
        override-build: |
            mkdir -p ${SNAPCRAFT_PART_INSTALL}/lib/node_modules/strangescout-server/
            tar cf - * | ( cd ${SNAPCRAFT_PART_INSTALL}/lib/node_modules/strangescout-server/; tar xfp -)
        stage:
            - lib
